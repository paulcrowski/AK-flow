# Daily Log: 2025-12-22

## üéØ Focus
Stabilizacja P0.1.2: artefakty (ID/name), autonomia (tylko WORK/SILENCE) + diagnostyka token√≥w (prompt stats) + utwardzenie RawContract.

---

## ‚úÖ Done (co realnie dowiezione)

### 1) Artifacts: jedna brama rozwiƒÖzywania referencji
- `stores/artifactStore.ts`: `normalizeArtifactRef()` (ID lub nazwa, kontrolowane NOT_FOUND/AMBIGUOUS).
- `utils/toolParser.ts`: u≈ºywa jednej bramy dla `APPEND/REPLACE/READ_ARTIFACT/PUBLISH`.

### 2) Autonomia: tylko WORK albo SILENCE (koniec CONTINUE/EXPLORE w autonomii)
- `core/systems/AutonomyRepertoire.ts`: `selectAction()` zwraca tylko `WORK` (gdy pending artifact) lub `SILENCE`.
- `core/systems/eventloop/AutonomousVolitionStep.ts`: `SILENCE` nie zwiƒôksza backoff (nie liczymy jako failure).

### 3) Action-First: polskie polecenia bez diakrytyk√≥w
- `core/systems/eventloop/ReactiveStep.ts`: `utworz/stworz/zrob` (bez `√≥`) dzia≈ÇajƒÖ.
- Dla fraz typu `utworz plik o kotkach` generujemy nazwƒô `.md` z frazy (slug) zamiast odpalaƒá ciƒô≈ºkie LLM.

### 4) Token audit v1
- `core/inference/CortexInference.ts`: metryka `CORTEX_PROMPT_STATS` (rozmiary promptu + sk≈Çad stanu) do diagnozy skok√≥w 5k-7k promptTokens.

### 5) RawContract hardening (fail-closed + bezpieczne obwiednie)
- `core/systems/RawContract.ts`: dopuszczone bezpieczne obwiednie: `{...}`, fenced JSON, oraz double-encoded JSON string.
- Prose prefix nadal fail-closed.

---

## üß™ Verification (ALARM-3)
- `npm run build` ‚úÖ PASS
- `npm test` ‚úÖ PASS (**588/588**)
- `npm test -- --run WiringValidator` ‚úÖ PASS

---

## üßæ Commits / Delivery
- `2a91bc5` P0.1.2: autonomy WORK/SILENCE + action-first create
- `d0cd0d0` P0.1.2: token audit prompt stats
- (day-close) RawContract hardening + docs + nexus

---

## ‚û°Ô∏è Next (tomorrow)
1) Autonomia jako praca (nie mowa): AgentTrajectory v1 (internal steps + outcome/friction).
2) Realne narzƒôdzia do pracy na katalogach: `READ_FILE` + `SEARCH_IN_REPO` jako pierwsze ‚Äûrƒôce‚Äù agenta.
3) Ustawiƒá minimalny workflow: WORK LOOP v1 (SCOPE ‚Üí EVIDENCE ‚Üí PATCH ‚Üí VERIFY).

---

## üóíÔ∏è Session Notes (P0.1.2 hardening)
- Artifacts: jedna brama `normalizeArtifactRef()` ‚Üí koniec `ARTIFACT_ID_INVALID` przy u≈ºyciu nazw.
- Autonomia: `WORK|SILENCE` + `SILENCE` nie nabija backoff.
- Action-First: obs≈Çuga `utworz/stworz/zrob` (bez diakrytyk√≥w) + generowanie `.md` z frazy.
- Token audit: `CORTEX_PROMPT_STATS` ‚Üí rozk≈Çad rozmiaru promptu i potencjalnych ≈∫r√≥de≈Ç 5k‚Äì7k token√≥w.
- RawContract: fail-closed, ale toleruje fenced JSON + double-encoded JSON.
